#############################################
# xunji-backup (后端) 环境变量示例
#############################################

############################
# 基础配置
############################

# [必须/可选] 必须
# [配置效果] 用于初始化 SQLAlchemy 连接与建表；配置错误会导致后端启动失败或无法读写数据。
# [格式/默认值] 字符串；默认示例：sqlite:///./xunji1.db
SQLALCHEMY_DATABASE_URL=sqlite:///./xunji.db

############################
# 知识库上传（/api/upload）与向量库持久化
############################

# [必须/可选] 必须（使用 /api/upload 或启用 enable_rag 时）
# [配置效果] Chroma 向量库持久化目录；目录不兼容可能导致启动或检索失败。
# [格式/默认值] 路径字符串；默认示例：./chroma_db
PERSIST_DIRECTORY=./chroma_db

# [必须/可选] 必须（使用 /api/upload 时）
# [配置效果] /api/upload 上传的知识库文件本地保存目录；仅用于知识库文件，不用于聊天附件。
# [格式/默认值] 路径字符串；默认示例：./rag_files
RAG_FILE_PATH=./rag_files

# [必须/可选] 必须（使用 /api/upload 时）
# [配置效果] 知识库文件落盘命名分隔符，用于拼接 file_id 与原文件名，便于排查与避免同名覆盖。
# [格式/默认值] 字符串；默认示例：__
SPLIT_FILENAME_ID=__

############################
# 模型调用（按需配置，取决于你选择的模型）
############################

# [必须/可选] 可选（仅在选择 gpt* 模型时必须）
# [配置效果] OpenAI API Key；未配置时选择 gpt* 会报错。
# [格式/默认值] 字符串；无默认值
OPENAI_API_KEY=

# [必须/可选] 可选（仅在选择 deepseek* 模型时必须）
# [配置效果] DeepSeek API Key；未配置时选择 deepseek* 会报错。
# [格式/默认值] 字符串；无默认值
DEEPSEEK_API_KEY=

# [必须/可选] 可选（仅在选择 deepseek* 模型时必须）
# [配置效果] DeepSeek OpenAI-compatible base_url（例如 https://api.deepseek.com）。
# [格式/默认值] URL 字符串；无默认值
DEEPSEEK_API_BASE=

# [必须/可选] 可选（仅在选择 kimi* / moonshot* 模型时必须）
# [配置效果] Moonshot API Key；未配置时选择 kimi* / moonshot* 会报错。
# [格式/默认值] 字符串；无默认值
MOONSHOT_API_KEY=

# [必须/可选] 可选（仅在选择 kimi* / moonshot* 模型时必须）
# [配置效果] Moonshot OpenAI-compatible base_url。
# [格式/默认值] URL 字符串；无默认值
MOONSHOT_BASE_URL=

# [必须/可选] 可选（仅在选择 qwen* 模型时必须）
# [配置效果] DashScope API Key（用于 Qwen LLM）。
# [格式/默认值] 字符串；无默认值
DASHSCOPE_API_KEY=

# [必须/可选] 可选（仅在选择 qwen* 模型时必须）
# [配置效果] DashScope OpenAI-compatible base_url（用于 Qwen LLM）。
# [格式/默认值] URL 字符串；无默认值
DASHSCOPE_BASE_URL=

# [必须/可选] 可选（仅在选择 gemini* 模型或启用联网搜索关键词生成时必须）
# [配置效果] Gemini API Key。
# [格式/默认值] 字符串；无默认值
GEMINI_API_KEY=

# [必须/可选] 可选（启用 enable_search 时必须）
# [配置效果] 用于“搜索关键词生成”的 Gemini 模型名。
# [格式/默认值] 字符串；无默认值（示例：gemini-1.5-flash）
GOOGLE_SEARCH_MODEL=

############################
# 联网搜索（Tavily）
############################

# [必须/可选] 可选（启用 enable_search 时必须）
# [配置效果] Tavily API Key；未配置时 enable_search 会失败或返回空。
# [格式/默认值] 字符串；无默认值
TAVILY_API_KEY=

############################
# RAG/Embedding（用于向量库检索）
############################

# [必须/可选] 可选
# [配置效果] 选择 RAG Embedding 提供方：ollama 或 dashscope。dashscope 需要额外依赖与 key。
# [格式/默认值] 字符串；默认：ollama
RAG_EMBEDDING_PROVIDER=dashscope

# [必须/可选] 可选（当 RAG_EMBEDDING_PROVIDER=ollama 时必须）
# [配置效果] Ollama 服务地址；用于向量库 embedding。
# [格式/默认值] URL 字符串；默认示例：http://localhost:11434
OLLAMA_BASE_URL=http://localhost:11434

# [必须/可选] 可选（当 RAG_EMBEDDING_PROVIDER=ollama 时必须）
# [配置效果] Ollama embedding 模型名；用于向量库 embedding。
# [格式/默认值] 字符串；无默认值（示例：nomic-embed-text）
EMBEDDING_MODEL=

# [必须/可选] 可选（当 RAG_EMBEDDING_PROVIDER=dashscope 时必须）
# [配置效果] DashScope embedding 模型名；用于向量库 embedding。
# [格式/默认值] 字符串；无默认值
QWEN_EMBEDDING_MODEL=

# [必须/可选] 可选（当 RAG_EMBEDDING_PROVIDER=dashscope 时必须）
# [配置效果] DashScope embedding API Key；用于向量库 embedding。
# [格式/默认值] 字符串；无默认值
QWEN_API_KEY=

# [必须/可选] 可选
# [配置效果] 文本切分块大小（字符）；增大会减少块数但每块更长，可能降低检索粒度。
# [格式/默认值] int；默认：2000
RAG_CHUNK_SIZE_CHARS=2000

# [必须/可选] 可选
# [配置效果] 文本切分重叠（字符）；增大会提升跨块连贯性但增加存储与计算。
# [格式/默认值] int；默认：200
RAG_CHUNK_OVERLAP_CHARS=200

# [必须/可选] 可选
# [配置效果] Chroma collection 名称；用于区分不同集合。
# [格式/默认值] 字符串；默认：zhiwei_knowledge_base
RAG_COLLECTION_NAME=zhiwei_knowledge_base

# [必须/可选] 可选
# [配置效果] 当 Chroma 数据目录不兼容导致初始化失败时，设 true 自动删除 PERSIST_DIRECTORY 并重建（会清空旧数据）。
# [格式/默认值] bool（true/false）；默认：false
RAG_RESET_ON_SCHEMA_ERROR=false

############################
# Windows OpenMP 兼容
############################

# [必须/可选] 可选
# [配置效果] 遇到 OpenMP 重复初始化错误时可设 TRUE 允许继续运行（存在潜在风险）。
# [格式/默认值] TRUE/FALSE；默认：TRUE
KMP_DUPLICATE_LIB_OK=TRUE

############################
# 聊天附件对象存储（阿里 OSS / 腾讯 COS）
############################

# [必须/可选] 可选（默认 disabled）
# [配置效果] 选择聊天附件的对象存储：aliyun/cos/disabled。disabled 表示不落 OSS，仅用于当次请求的本地预览与模型理解。
# [格式/默认值] 字符串；默认：disabled
OBJECT_STORAGE_PROVIDER=disabled

# [必须/可选] 可选
# [配置效果] signed URL 默认有效期（秒）；前端获取附件 URL 时会用该默认值。
# [格式/默认值] int；默认：600
SIGNED_URL_EXPIRES_SECONDS_DEFAULT=600

# [必须/可选] 可选
# [配置效果] signed URL 最大有效期（秒）；后端会对请求的 expires_seconds 做上限限制。
# [格式/默认值] int；默认：604800（7天）
SIGNED_URL_EXPIRES_SECONDS_MAX=604800

############################
# 阿里云 OSS（当 OBJECT_STORAGE_PROVIDER=aliyun 时需要）
############################

# [必须/可选] 可选（当 OBJECT_STORAGE_PROVIDER=aliyun 时必须）
# [配置效果] 阿里云 AccessKeyId。
# [格式/默认值] 字符串；无默认值
ALIYUN_OSS_ACCESS_KEY_ID=

# [必须/可选] 可选（当 OBJECT_STORAGE_PROVIDER=aliyun 时必须）
# [配置效果] 阿里云 AccessKeySecret。
# [格式/默认值] 字符串；无默认值
ALIYUN_OSS_ACCESS_KEY_SECRET=

# [必须/可选] 可选（当 OBJECT_STORAGE_PROVIDER=aliyun 时必须）
# [配置效果] OSS Endpoint（例如 https://oss-cn-hangzhou.aliyuncs.com）。
# [格式/默认值] URL 字符串；无默认值
ALIYUN_OSS_ENDPOINT=

# [必须/可选] 可选（当 OBJECT_STORAGE_PROVIDER=aliyun 且使用 V4 签名时建议/可能必需）
# [配置效果] OSS Region（例如 cn-hangzhou）；用于 V4 presigned URL 场景更稳定。
# [格式/默认值] 字符串；默认空
ALIYUN_OSS_REGION=

# [必须/可选] 可选（当 OBJECT_STORAGE_PROVIDER=aliyun 时必须）
# [配置效果] OSS Bucket 名称。
# [格式/默认值] 字符串；无默认值
ALIYUN_OSS_BUCKET=

# [必须/可选] 可选
# [配置效果] 对象 key 前缀；用于隔离不同业务目录。
# [格式/默认值] 字符串；默认：chat-attachments
ALIYUN_OSS_PREFIX=chat-attachments

############################
# 腾讯 COS（当 OBJECT_STORAGE_PROVIDER=cos 时需要）
############################

# [必须/可选] 可选（当 OBJECT_STORAGE_PROVIDER=cos 时必须）
# [配置效果] 是否启用 COS 上传；若为 false 则 cos provider 无法工作。
# [格式/默认值] bool（true/false）；默认：false
COS_UPLOAD_ENABLED=false

# [必须/可选] 可选（当 OBJECT_STORAGE_PROVIDER=cos 且 COS_UPLOAD_ENABLED=true 时必须）
# [配置效果] COS SecretId。
# [格式/默认值] 字符串；无默认值
COS_SECRET_ID=

# [必须/可选] 可选（当 OBJECT_STORAGE_PROVIDER=cos 且 COS_UPLOAD_ENABLED=true 时必须）
# [配置效果] COS SecretKey。
# [格式/默认值] 字符串；无默认值
COS_SECRET_KEY=

# [必须/可选] 可选（当 OBJECT_STORAGE_PROVIDER=cos 且 COS_UPLOAD_ENABLED=true 时必须）
# [配置效果] COS Region。
# [格式/默认值] 字符串；无默认值
COS_REGION=

# [必须/可选] 可选（当 OBJECT_STORAGE_PROVIDER=cos 且 COS_UPLOAD_ENABLED=true 时必须）
# [配置效果] COS Bucket 名称。
# [格式/默认值] 字符串；无默认值
COS_BUCKET=

# [必须/可选] 可选
# [配置效果] 对象 key 前缀；用于隔离不同业务目录。
# [格式/默认值] 字符串；默认：chat-attachments
COS_PREFIX=chat-attachments

# [必须/可选] 可选
# [配置效果] 自定义公开访问域名（不建议用于私有桶）；不填则使用 SDK 生成 URL。
# [格式/默认值] URL 字符串；默认空
COS_PUBLIC_BASE_URL=

############################
# OpenClaw
############################

# [必须/可选] 可选
# [配置效果] Gateway 的 WebSocket 地址
# [格式/默认值] URL 字符串；默认：ws://127.0.0.1:18789
OPENCLAW_GATEWAY_URL=ws://127.0.0.1:18789

# [必须/可选] 可选
# [配置效果] 你的用户 Token
# [格式/默认值] 字符串
OPENCLAW_GATEWAY_TOKEN=hadage

# [必须/可选] 可选
# [配置效果] 当前连接的会话id
# [格式/默认值] 字符串
OPENCLAW_SESSION_KEY=xunji-agent

############################
# SSH Tunnel (OpenClaw)
############################

# [必须/可选] 可选
# [配置效果] SSH 隧道主机地址
SSH_HOST=
# [必须/可选] 可选
# [配置效果] SSH 隧道端口
SSH_PORT=22
# [必须/可选] 可选
# [配置效果] SSH 用户名
SSH_USER=
# [必须/可选] 可选
# [配置效果] SSH 密码
SSH_PASSWORD=
